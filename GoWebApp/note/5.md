## 第５章

- Webテンプレートとはあらかじめ設計されたwebページであり、テンプレートエンジンと呼ばれるプログラムによって繰り返し利用される。
- webアプリケーションの重要な構成部分。
- Goにもあらかじめいくつかのテンプレートエンジンが組み込まれている。

### 5.1 テンプレートとテンプレートエンジン
- テンプレートエンジンは大奥の場合テンプレートにデータを組み込んで最終的なHTMLを生成する。
- 通常、ハンドラがテンプレートエンジンを呼び出してテンプレートに組み込み、出来上がってHTMLをクライアントに返す。
- 企画は無いが、大きく２つの架空のテンプレートエンジンを考えることが出来る。
  - ロジックなしのテンプレートエンジン
    - 完全に理想的なロジックなしのテンプレートエンジンは実用性に欠ける
  - ロジックありのテンプレートエンジン
    - ロジックをテンプレートに埋め込めるため強力だが、ロジックが複数箇所に分散してコードの保守性が低下する
### 5.2 Goのテンプレートエンジン
- ロジックなしとありの中間のような存在
- GO言語のテンプレートはテキストドキュメントであり、アクションと呼ばれるコマンドが埋めこまれている
- このテキストがテンプレートエンジンによって解析され実行されることで新たなテキストが生成される
- アクションは「{{...}}」で囲うことで記述する
- Gog言語のテンプレートエンジンを使用する手順
  1. テキスト形式のテンプレートソースを解析してテンプレート構造体を生成
  2. ResponseWriterと何らかのデータを引数として解析済みのテンプレートを実行

### 5.3 アクション
- Goには広範なアクション一式が用意されており、大変強力で柔軟性をもたらす
### 5.3.1 条件アクション
- 多数のデータ評価値の中から引数の値に応じて１つを選択するもの
### 5.3.2 イテレータアクション
- 配列やスライス、マップ、チャネルの要素ごとに反復処理を行うアクション
- 反復ループの中ではドットに配列等の要素が次々と設定される
### 5.3.3 代入アクション
- そのアクションで囲まれたセクション内で有効な値をドットの値として設定できる
### 5.3.4 インクルードアクション
- テンプレートの中に次のテンプレートを差し込む

## 5.4 引数、変数、パイプライン
- 「引数」はテンプレート内で使用される価
  - ブール価や整数、文字列など
  - 構造体や構造体のフィールド、マップのキーとなる場合もある
  - ドル記号を用いてアクション内で変数を設定することも出来る
- 「パイプライン」とは引数や関数、メソッドを直列に繋げたもの
  - 引数の出力を|で区切って次の引数に遅れる

## 5.5 関数
- GO言語では関数も引数に出来る
  - テンプレートエンジンには基本的な組み込み関数一式が用意されている
  - プログラマーが独自の関数を定義出来る

## 5.6 コンテキスト依存処理
- Go言語のテンプレートの非常に興味深い特徴の１つは、表示するコンテンツをコンテキストに応じて変えられること
  - 表示されるコンテンツがドキュメント内のどこにそれを置いたかで変わる
  - 分かりやすい処理は表示コンテンツに適切なエスケープ処理をすること